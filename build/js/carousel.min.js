(function(){"use strict";const BREAKPOINT=992;const DEBOUNCE_DELAY=100;const SCROLL_ANIMATION_DURATION=300;document.addEventListener("DOMContentLoaded",initCarousel);function initCarousel(){const videosSection=document.getElementById("videos");if(!videosSection)return;const shortsGrid=videosSection.querySelector(".shorts-grid");if(!shortsGrid)return;const state={isCarouselActive:false,isDragging:false,touchData:{startX:0,endX:0},dragData:{startX:0,scrollLeft:0},scrollTimer:null};const carousel={setup(){const shouldActivateCarousel=window.innerWidth<BREAKPOINT;if(shouldActivateCarousel===state.isCarouselActive)return;shouldActivateCarousel?activateCarousel():deactivateCarousel();state.isCarouselActive=shouldActivateCarousel},updateIndicators(activeIndex){const indicators=videosSection.querySelectorAll(".indicator-dot");indicators.forEach(((dot,index)=>{dot.classList.toggle("active",index===activeIndex)}))},updateActiveItem(newActiveItem){if(!newActiveItem)return;const items=shortsGrid.querySelectorAll(".shorts-item");items.forEach((item=>item.classList.remove("active")));newActiveItem.classList.add("active");const targetScrollLeft=newActiveItem.offsetLeft-(shortsGrid.offsetWidth-newActiveItem.offsetWidth)/2;if("scrollBehavior"in document.documentElement.style){shortsGrid.scrollTo({left:targetScrollLeft,behavior:"smooth"})}else{animateScroll(targetScrollLeft)}}};function activateCarousel(){shortsGrid.classList.add("carousel-active");createIndicators();attachEventListeners();setupInitialActiveItem()}function deactivateCarousel(){shortsGrid.classList.remove("carousel-active");resetItems();removeIndicators();detachEventListeners()}function createIndicators(){if(videosSection.querySelector(".carousel-indicators"))return;const items=shortsGrid.querySelectorAll(".shorts-item");if(items.length===0)return;const indicators=document.createElement("div");indicators.className="carousel-indicators";items.forEach(((_,index)=>{const dot=document.createElement("span");dot.className="indicator-dot";if(index===0)dot.classList.add("active");dot.addEventListener("click",(()=>{carousel.updateActiveItem(items[index]);carousel.updateIndicators(index)}));indicators.appendChild(dot)}));shortsGrid.parentNode.insertBefore(indicators,shortsGrid.nextSibling)}function handleScroll(){if(state.scrollTimer)clearTimeout(state.scrollTimer);state.scrollTimer=setTimeout((()=>{if(!state.isDragging){findAndActivateClosestItem()}}),DEBOUNCE_DELAY)}function findAndActivateClosestItem(){const items=shortsGrid.querySelectorAll(".shorts-item");const centerX=shortsGrid.scrollLeft+shortsGrid.offsetWidth/2;let closestItem=null;let closestDistance=Infinity;items.forEach((item=>{const itemCenter=item.offsetLeft+item.offsetWidth/2;const distance=Math.abs(itemCenter-centerX);if(distance<closestDistance){closestDistance=distance;closestItem=item}}));if(closestItem){const activeIndex=Array.from(items).indexOf(closestItem);carousel.updateIndicators(activeIndex);if(!closestItem.classList.contains("active")){items.forEach((item=>item.classList.remove("active")));closestItem.classList.add("active")}}}function setupInitialActiveItem(){const items=shortsGrid.querySelectorAll(".shorts-item");if(items.length>0){items[0].classList.add("active");carousel.updateIndicators(0)}}function resetItems(){const items=shortsGrid.querySelectorAll(".shorts-item");items.forEach((item=>{item.classList.remove("active");item.removeAttribute("style")}))}function removeIndicators(){const indicators=videosSection.querySelector(".carousel-indicators");if(indicators){indicators.remove()}}function startDrag(e){if(shortsGrid.contains(e.target)){e.preventDefault();e.stopPropagation();state.isDragging=true;state.dragData.startX=e.pageX-shortsGrid.offsetLeft;state.dragData.scrollLeft=shortsGrid.scrollLeft;shortsGrid.classList.add("grabbing")}}function drag(e){if(!state.isDragging)return;e.preventDefault();e.stopPropagation();const x=e.pageX-shortsGrid.offsetLeft;const walk=x-state.dragData.startX;shortsGrid.scrollLeft=state.dragData.scrollLeft-walk}function endDrag(){if(!state.isDragging)return;state.isDragging=false;shortsGrid.classList.remove("grabbing");findAndActivateClosestItem()}function handleTouchStart(event){if(shortsGrid.contains(event.target)){event.stopPropagation();state.touchData.startX=event.changedTouches[0].screenX;state.dragData.startX=event.touches[0].pageX-shortsGrid.offsetLeft;state.dragData.scrollLeft=shortsGrid.scrollLeft;shortsGrid.classList.add("grabbing")}}function handleTouchMove(event){if(shortsGrid.contains(event.target)){event.stopPropagation();const x=event.touches[0].pageX-shortsGrid.offsetLeft;const walk=x-state.dragData.startX;shortsGrid.scrollLeft=state.dragData.scrollLeft-walk}}function handleTouchEnd(event){if(shortsGrid.contains(event.target)){event.stopPropagation();state.touchData.endX=event.changedTouches[0].screenX;shortsGrid.classList.remove("grabbing");findAndActivateClosestItem()}}function animateScroll(targetPosition){const startPosition=shortsGrid.scrollLeft;const distance=targetPosition-startPosition;let startTime=null;function step(timestamp){if(!startTime)startTime=timestamp;const elapsed=timestamp-startTime;const progress=Math.min(elapsed/SCROLL_ANIMATION_DURATION,1);const easeProgress=.5-.5*Math.cos(progress*Math.PI);shortsGrid.scrollLeft=startPosition+distance*easeProgress;if(elapsed<SCROLL_ANIMATION_DURATION){window.requestAnimationFrame(step)}}window.requestAnimationFrame(step)}function attachEventListeners(){shortsGrid.addEventListener("mousedown",startDrag,{passive:false});shortsGrid.addEventListener("touchstart",handleTouchStart,{passive:true});shortsGrid.addEventListener("touchend",handleTouchEnd,{passive:true});shortsGrid.addEventListener("touchmove",handleTouchMove,{passive:true});shortsGrid.addEventListener("scroll",handleScroll);window.addEventListener("mouseup",endDrag);window.addEventListener("mousemove",drag,{passive:false})}function detachEventListeners(){shortsGrid.removeEventListener("mousedown",startDrag);shortsGrid.removeEventListener("touchstart",handleTouchStart);shortsGrid.removeEventListener("touchend",handleTouchEnd);shortsGrid.removeEventListener("touchmove",handleTouchMove);shortsGrid.removeEventListener("scroll",handleScroll);window.removeEventListener("mouseup",endDrag);window.removeEventListener("mousemove",drag)}function observeContentChanges(){const observer=new MutationObserver((mutations=>{for(const mutation of mutations){if(mutation.type==="childList"&&mutation.addedNodes.length>0){setTimeout(carousel.setup,100);break}}}));observer.observe(shortsGrid,{childList:true});window.addEventListener("beforeunload",(()=>observer.disconnect()))}window.addEventListener("resize",(()=>{requestAnimationFrame(carousel.setup)}));carousel.setup();observeContentChanges()}})();